CREATE TABLE Employee (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name NVARCHAR(300),
    salary INTEGER,
    department NVARCHAR(300),
    city NVARCHAR(300));

INSERT INTO Employee (name, salary, department, city) VALUES 
    ('John Smith', 5000, 'Marketing', 'New York'),
    ('Jane Doe', 6000, 'Engineering', 'Chicago'),
    ('Bob Johnson', 4500, 'Engineering', 'Pune'),
    ('Sarah Lee', 5500, 'HR', 'Pune'),
    ('Alice', 7000, 'HR', 'San Francisco'),
    ('Emily', 6500, 'Sales', 'San Francisco');

SELECT "NAME", SALARY FROM EMPLOYEE WHERE SALARY > (SELECT AVG(SALARY) FROM EMPLOYEE);

SELECT CONCAT(CONCAT("NAME", ' '), SALARY) AS NS FROM EMPLOYEE;

SELECT NAME, CITY FROM EMPLOYEE GROUP BY City, NAME ORDER BY CITY;

ALTER TABLE "PUBLIC".EMPLOYEE ADD FOREIGN KEY (department_id)
    REFERENCES "PUBLIC".DEPARTMENT(id)
    ON DELETE SET NULL;

ALTER TABLE "PUBLIC".EMPLOYEE DROP COLUMN department;

SELECT e.name FROM "PUBLIC".EMPLOYEE e
JOIN department d on (e.DEPARTMENT_ID = d.ID)
WHERE d.ID = 2 AND e.WORK_START_DATE >= '2021-06-01'
